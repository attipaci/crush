# ============================================================================
# CRUSH default configuration file for MUSTANG-2
# Author: Attila Kovacs
# ============================================================================

# The ordering of models in the default reduction pipeline.  
ordering offsets, drifts, correlated.obs-channels, correlated.accel-mag, weighting.frames, filter, weighting, despike, despike2, despike3, correlated.gradients, correlated.mux, source

# The stability time-scale of the detectors in seconds (1 / 2fc). 
stability 10.0 
 
# Specify the unit of the raw data 
dataunit rad 
 
# Specify the acceptable range of readout signals (in dataunit). 
#range -3.1:3.1 
 
# Specify the units in which the ouput map should be written. Use 'V/beam' 
# to get uncalibrated data in detector voltage units, or 'Jy/beam' to write 
# calibrated data, with the calibration factor defined via the 'jansky' option 
# above 
unit Jy/beam 

# Give the conversion factor (rad/Jy).
jansky 1.0

# Set the instrument beam FWHM in arcsec 
beam 7.6

# Set the map grid at ~1/4 beam
grid 1.5

# Some scans may be undersampled on the default map grid. For these you can
# use the '-sparse' flag on the command line to project onto a coarser grid.
[sparse] grid 3.0
[sparse] regrid 1.5

# The overall instrument gain
gain -1.0

# The minimum fraction of active pixels required for map generation
mappingfraction 0.25

# Load the canonical resonator frequencies
frequencies.1 {@CRUSH}/mustang2/m1_resonance.txt
frequencies.2 {@CRUSH}/mustang2/m2_resonance.txt

# Load the pixel positions
positions {@CRUSH}/mustang2/skyoff_July2015

# Specify the pixel offsets for each readout...
offset.1 13.9,-6.7
offset.2 4.8,1.9

# Specify the pixel rotations for each readout...
rotation.1 -169.1
rotation.2 178.3

# NUmber of fitting attempts before resonance identification
#pixelid.attemps 100

# The range of df/f to explore
pixelid.deltarange -1e-3:1e-3

# The fitting cost-function power index (e.g. 2.0 for traditional chi^2)
pixelid.power 0.5

# The maximum deviation (sigmas) before an ID is considered invalid.
pixelid.max 4.0

# Load the pixel gains, weights, flags and coupling efficiencies
#pixeldata {@CRUSH}/mustang2/pixel.dat

# Remove the scan synchronous signals, e.g. telescope vibrations. 
#filter.motion 
 
# Clip data where the telescope acceleration exceeds 8'/s^2. 
#aclip 20.0 
 
# Force positive pixel gains 
#array.signed 
 
# For extended sources, slow down the atmospheric decorrelation 
#[extended] array.resolution 1.0 
 
# Define 'mux' as a shorthand for 'correlated.mux' 
alias.mux correlated.mux 

# Decorrelate on readout lines.
#mux
iteration.[2] mux
#mux.signed
#mux.gainRange 0.3:3.0

# Smooth intermediate maps somewhat to increase map redundancy
smooth beam

# Define 'accel' as a shorthand for 'correlated.accel-mag' 
alias.accel correlated.accel-mag 

# Remove acceleration response 
# accel 

# For extended, assume a source diameter of 1 arcmin. 
#[extended] sourcesize 60.0 


